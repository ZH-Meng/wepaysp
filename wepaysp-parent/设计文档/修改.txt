

 weixin_pay_details_t 中的`trade_status`  使用说明：0：交易中  1：交易成功 2：交易失败  3:交易撤销（标准流程中自动触发的交易撤销）  4：交易关闭

`weixin_refund_details_t` 的交易撤销当做退款用。  这种交易撤销不用变更weixin_pay_details_t 的`trade_status`  ，但是需要更新它的退款金额字段。


ALTER TABLE `RPT_DEALER_STAT_DAY_T`
ADD COLUMN `REFUND_AMOUNT`  NUMERIC(16)  COMMENT '退款总笔数' AFTER `PARTNER_EMPLOYEE_NAME`;

ALTER TABLE `RPT_DEALER_STAT_DAY_T`
ADD COLUMN `REFUND_MONEY`  NUMERIC(20)  COMMENT '退款总金额 单位：分' AFTER `REFUND_AMOUNT`;

ALTER TABLE `RPT_DEALER_STAT_DAY_T`
ADD COLUMN `PAY_AMOUNT`  NUMERIC(16)  COMMENT '收款总笔数' AFTER `REFUND_MONEY`;

ALTER TABLE `RPT_DEALER_STAT_DAY_T`
ADD COLUMN `PAY_MONEY`  NUMERIC(16)  COMMENT '收款总笔数 单位：分' AFTER `PAY_AMOUNT`;

 

ALTER TABLE `RPT_DEALER_STAT_MONTH_T`
ADD COLUMN `REFUND_AMOUNT`  NUMERIC(16)  COMMENT '退款总笔数' AFTER `PARTNER_EMPLOYEE_NAME`;

ALTER TABLE `RPT_DEALER_STAT_MONTH_T`
ADD COLUMN `REFUND_MONEY`  NUMERIC(20)  COMMENT '退款总金额 单位：分' AFTER `REFUND_AMOUNT`;

ALTER TABLE `RPT_DEALER_STAT_MONTH_T`
ADD COLUMN `PAY_AMOUNT`  NUMERIC(16)  COMMENT '收款总笔数' AFTER `REFUND_MONEY`;

ALTER TABLE `RPT_DEALER_STAT_MONTH_T`
ADD COLUMN `PAY_MONEY`  NUMERIC(16)  COMMENT '收款总笔数 单位：分' AFTER `PAY_AMOUNT`;




ALTER TABLE `weixin_refund_details_t`
MODIFY COLUMN `APPID`  varchar(32) CHARACTER SET utf8 COLLATE utf8_general_ci NULL COMMENT '微信公众号ID' AFTER `PARTNER_EMPLOYEE_OID`,
MODIFY COLUMN `NONCE_STR`  varchar(32) CHARACTER SET utf8 COLLATE utf8_general_ci NULL COMMENT '随机字符串' AFTER `DEVICE_INFO`,
MODIFY COLUMN `SIGN`  varchar(32) CHARACTER SET utf8 COLLATE utf8_general_ci NULL COMMENT '签名' AFTER `NONCE_STR`,
MODIFY COLUMN `TOTAL_FEE`  int(11) NULL COMMENT '订单总金额  单位为分  只能为整数' AFTER `COUPON_REFUND_TYPE`,
MODIFY COLUMN `REFUND_FEE`  int(11) NULL COMMENT '申请退款金额' AFTER `TOTAL_FEE`,
MODIFY COLUMN `RETURN_CODE`  varchar(16) CHARACTER SET utf8 COLLATE utf8_general_ci NULL COMMENT 'SUCCESS/FAIL此字段是通信标识' AFTER `REFUND_ACCOUNT`,
MODIFY COLUMN `RESULT_CODE`  varchar(16) CHARACTER SET utf8 COLLATE utf8_general_ci NULL COMMENT '业务结果' AFTER `RETURN_MSG`;
ADD COLUMN `END_TIME`  TIMESTAMP  COMMENT '退款完成时间' AFTER `trans_end_time`;
ADD COLUMN `trade_status`  int(11)   COMMENT '退款状态 0：交易中  1：退款成功 2：退款失败 ' AFTER `END_TIME`  ;
ADD COLUMN `COUPON_REFUND_TYPE`  int(11) NULL COMMENT '1：撤销  2：退款' AFTER `TRANSACTION_ID`;
ADD COLUMN `WEIXIN_PAY_DETAILS_OID`  CHAR(32)  COMMENT '支付明细OID' AFTER `IWOID`;


